---
title: "Challenge 3 - Classification with Neural Networks"
author: "Sahil Gill, Luke Ingram"
subtitle: "MATH 318 - Winter 2023"
output: html_notebook
---

## Section 1 - Why Neural Nets?

TODO ADVANTAGES OF NEURAL NETS

## Section 2 - The Architecture

### Section 2.1 - 

## Section 3 - MobileNetV2 in Action

Before we begin, we need to load & normalize our data.

```{python}
#Load data 
dirName = "../src/data/archive/zero-indexed-files.txt"
imgPath = "../src/data/archive/Garbage_classification/load/"

df = pd.read_csv(dirName,sep=' ')

df['image'] = imgPath + df['image'].astype(str)
df['image'] = df['image'].apply(lambda x: cv2.resize(cv2.imread(x),(224,224)))
print(df.head()) #DEBUG

train_X,test_X,train_Y,test_Y = train_test_split(df['image'],df['class'],
                                                 test_size=0.20,random_state=42,stratify=df['class'])


train_X,val_X,train_Y,val_Y = train_test_split(train_X,train_Y,
                                               test_size=0.20,random_state=42,stratify=train_Y)


```

### Section 3.1 - Initializing MobileNetV2

```{python}
# Fetch network from keras, & define custom params. 
# This is a pre-trained model,bbut we remove the last layer & train it ourselves to fit out problem
model = tf.keras.applications.mobilenet_v2.MobileNetV2(
    input_shape = None, 
    alpha = 1.0, # using default input width
    include_top = True, #include fully-connected input layer
    weights = 'imagenet', # Default weights
    input_tensor = None, # using defualt input tensor structure
    pooling = None, # not using this feature
    classes = 1000, # default
    classifier_activation = 'softmax' #specify activation function of output layer
)   
```

TODO: Explain this line-by-line

### Section 3.2 - Customized Output Layers

```{python}
final_layer = model.layers[-2].output

output_layer = tf.keras.layers.Dense(72,activation='relu')(final_layer)
output_layer = tf.keras.layers.Dense(36,activation='relu')(final_layer)
output_layer = tf.keras.layers.Dense(6,activation='softmax')(final_layer)

# add it back to model
model = tf.keras.Model(inputs = model.layers[0].input,outputs = output_layer)

```

TODO:

## Section 4 - Results & Comparison with Previous Methods

TODO
